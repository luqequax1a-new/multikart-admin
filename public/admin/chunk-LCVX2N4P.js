import{a as Oe}from"./chunk-M3HD75V3.js";import{a as Ee,b as ze,c as ke,e as Fe}from"./chunk-QVI36XHK.js";import{a as De,b as Pe,c as Ve,d as Be,e as Ae}from"./chunk-DNDGKAFO.js";import{a as Se}from"./chunk-3ARB4UI6.js";import{a as Te}from"./chunk-HD5XXWEJ.js";import{a as Ne}from"./chunk-HJPVTB2W.js";import{a as we}from"./chunk-MLWMDQKS.js";import{a as be}from"./chunk-Q3XL2YFP.js";import{$ as xe,C as ce,D as ge,Ia as ye,U as K,V as _e,X as ue,Y as fe,Z as he,_ as ve,aa as Me,ba as Ce,d as le,fa as Ie,g as se,k as re,p as me,qa as D,v as de,w as pe}from"./chunk-IKKQDHIF.js";import{c as $,d as R}from"./chunk-AWERIOQH.js";import{Ac as ie,Ad as oe,Bc as N,Ca as V,Cc as q,Ib as M,J as H,Kb as C,Lc as p,Mb as A,Mc as c,N as Y,Nb as E,Ob as z,Pb as d,Pc as ae,Qb as s,Rb as r,Sb as I,Xc as S,Yc as x,Za as j,Zc as O,_b as y,bb as o,bc as h,dc as m,gb as X,ja as b,kc as k,lc as F,mc as Q,ob as B,qa as u,qc as W,ra as f,rc as _,sc as v,tc as Z,td as ne,ub as T,uc as U,va as J,yc as ee,zc as te}from"./chunk-KIZZVTEV.js";import{d as G}from"./chunk-4CLCTAJ7.js";var L={image:["image/apng","image/avif","image/gif","image/jpeg","image/png","image/svg","image/svg+xml","image/webp"],video:["video/mp4","video/webm","video/ogg"],audio:["audio/mpeg","audio/wav","audio/ogg"],downloadFile:["application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-powerpoint","application/vnd.openxmlformats-officedocument.presentationml.presentation","application/zip","application/x-tar","application/gzip","text/plain"]};var Qe=["deleteModal"];function We(i,l){i&1&&(s(0,"div",10),I(1,"app-loader",14),r()),i&2&&(o(),d("loaderClass","custom-loader-wrapper"))}function Ue(i,l){if(i&1&&I(0,"img",20),i&2){let t=m().$implicit;d("src",t.original_url,j)}}function qe(i,l){if(i&1&&I(0,"img",20),i&2){let t=m().$implicit,e=m(3);d("src",e.getMimeTypeImage(t.mime_type),j)}}function Ke(i,l){if(i&1){let t=y();s(0,"div")(1,"div",16)(2,"input",17),h("change",function(a){let n=u(t).$implicit,g=m(3);return f(g.selectImage(a,n,g.url()))}),r(),s(3,"label",18)(4,"div",19),M(5,Ue,1,1,"img",20)(6,qe,1,1,"img",20),r()()()()}if(i&2){let t=l.$implicit,e=m(3);o(2),d("type",N(e.multiple()?"checkbox":"radio"))("id",q("attachment-",t==null?null:t.id))("checked",!!(e.selected!=null&&e.selected.includes(t.id)||e.selected!=null&&e.selected.includes(t.original_url)))("value",t==null?null:t.id),o(),d("for",q("attachment-",t==null?null:t.id)),o(2),C(t.mime_type&&t.mime_type.startsWith("image")?5:6)}}function Ge(i,l){if(i&1&&(s(0,"div",15),E(1,Ke,7,9,"div",null,A),p(3,"async"),r()),i&2){let t,e=m(2);o(),z((t=c(3,0,e.attachment$))==null?null:t.data)}}function He(i,l){if(i&1&&(M(0,Ge,4,2,"div",15),p(1,"async")),i&2){let t,e=m();C(!((t=c(1,1,e.attachment$))==null||t.data==null)&&t.data.length?0:-1)}}function Ye(i,l){if(i&1){let t=y();s(0,"nav",11)(1,"app-pagination",21),h("setPage",function(a){u(t);let n=m();return f(n.setPaginate(a))}),r()()}if(i&2){let t=m();o(),d("total",t.totalItems)("currentPage",t.filter.page)("pageSize",t.filter.paginate)}}function Je(i,l){i&1&&I(0,"app-no-data",12),i&2&&d("image","assets/svg/no-media.png")("text","No Media Found")}var $e=(()=>{let l=class l{constructor(){this.store=b(D),this.document=b(J),this.renderer=b(X),this.attachment$=b(D).select(Fe.attachment),this.DeleteModal=O("deleteModal"),this.multiple=x(!1),this.url=x(!1),this.deleteAction=x(!0),this.accept=x(void 0),this.loading=!0,this.setImage=S(),this.setDeleteImage=S(),this.term=new re,this.filter={search:"",field:"",mime_type:"",sort:"",page:1,paginate:50},this.totalItems=0,this.mimeImageMapping=[{mimeType:"application/pdf",imagePath:"assets/images/pdf.png"},{mimeType:"application/msword",imagePath:"assets/images/word.png"},{mimeType:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",imagePath:"assets/images/word.png"},{mimeType:"application/vnd.ms-excel",imagePath:"assets/images/xls.png"},{mimeType:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",imagePath:"assets/images/xls.png"},{mimeType:"application/vnd.ms-powerpoint",imagePath:"assets/images/folder.png"},{mimeType:"application/vnd.openxmlformats-officedocument.presentationml.presentation",imagePath:"assets/images/folder.png"},{mimeType:"text/plain",imagePath:"assets/images/txt.png"},{mimeType:"audio/mpeg",imagePath:"assets/images/sound.png"},{mimeType:"audio/wav",imagePath:"assets/images/sound.png"},{mimeType:"audio/ogg",imagePath:"assets/images/sound.png"},{mimeType:"video/mp4",imagePath:"assets/images/video.png"},{mimeType:"video/webm",imagePath:"assets/images/video.png"},{mimeType:"video/ogg",imagePath:"assets/images/video.png"},{mimeType:"application/zip",imagePath:"assets/images/zip.png"},{mimeType:"application/x-tar",imagePath:"assets/images/zip.png"},{mimeType:"application/gzip",imagePath:"assets/images/zip.png"}]}ngOnChanges(e){e.accept?.currentValue?.length&&(this.mediaType=e.accept?.currentValue);let a=this.selectedImages();a.length&&(this.selected=a?.map(n=>n?.id?n?.id:n))}ngOnInit(){this.getAttachments(this.filter,!0),this.attachment$.subscribe(e=>this.totalItems=e?.total),this.term.valueChanges.pipe(H(400),Y()).subscribe(e=>{this.filter.search=e,this.getAttachments(this.filter)})}getAttachments(e,a){this.mediaType?.length&&(this.filter.mime_type=this.mediaType.join()),this.loading=!(a&&this.deleteAction()),this.store.dispatch(new Ee(e)).subscribe({complete:()=>{this.loading=!1}}),a||this.renderer.addClass(this.document.body,"loader-none")}onMediaChange(e){this.filter.sort=e.target.value,this.getAttachments(this.filter)}onActionClicked(e,a){e=="delete"&&this.store.dispatch(new ke(a.id)).subscribe({complete:()=>{this.setDeleteImage.emit(a.id)}})}selectImage(e,a,n){if(this.multiple()){let g=this.selectedImages().indexOf(a);e.target.checked?g===-1&&this.selectedImages().push(a):this.selectedImages=this.selectedImages().filter(w=>w.id!==parseInt(e.target.value))}else this.selectedImages=a;n&&(this.selectedImages=a),this.setImage.emit(this.selectedImages())}setPaginate(e){this.filter.page=e,this.getAttachments(this.filter)}getMimeTypeImage(e){return this.mimeImageMapping.find(a=>a.mimeType==e)?.imagePath}ngOnDestroy(){this.renderer.removeClass(this.document.body,"loader-none")}};l.\u0275fac=function(a){return new(a||l)},l.\u0275cmp=B({type:l,selectors:[["app-media-box"]],viewQuery:function(a,n){a&1&&k(n.DeleteModal,Qe,5),a&2&&F()},inputs:{multiple:[1,"multiple"],url:[1,"url"],deleteAction:[1,"deleteAction"],accept:[1,"accept"],loading:"loading",selectedImages:"selectedImages"},outputs:{setImage:"setImage",setDeleteImage:"setDeleteImage"},features:[V],decls:29,vars:27,consts:[["deleteModal",""],[1,"select-top-panel"],["type","text",1,"form-control",3,"placeholder","formControl"],[1,"form-select",3,"change"],["value",""],["value","newest"],["value","oldest"],["value","smallest"],["value","largest"],[1,"content-section","select-file-section","py-0","ratio2_3","custom-box-loader"],[1,"box-loader"],[1,"custom-pagination"],[3,"image","text"],[3,"deleteItem"],[3,"loaderClass"],[1,"row","row-cols-xxl-6","row-cols-xl-5","row-cols-lg-4","row-cols-sm-3","row-cols-2","g-sm-3","g-2","media-library-sec","ratio_square"],[1,"library-box"],["name","attachment",1,"media-checkbox",3,"change","type","checked","value","id"],[3,"for"],[1,"ratio","ratio-1x1"],["alt","attachment",1,"img-fluid",3,"src"],[3,"setPage","total","currentPage","pageSize"]],template:function(a,n){if(a&1){let g=y();s(0,"div",1)(1,"div"),I(2,"input",2),p(3,"translate"),r(),s(4,"select",3),h("change",function(P){return u(g),f(n.onMediaChange(P))}),s(5,"option",4),_(6),p(7,"translate"),r(),s(8,"option",5),_(9),p(10,"translate"),r(),s(11,"option",6),_(12),p(13,"translate"),r(),s(14,"option",7),_(15),p(16,"translate"),r(),s(17,"option",8),_(18),p(19,"translate"),r()()(),s(20,"div",9),M(21,We,2,1,"div",10)(22,He,2,3),M(23,Ye,2,3,"nav",11),p(24,"async"),M(25,Je,1,2,"app-no-data",12),p(26,"async"),r(),s(27,"app-delete-modal",13,0),h("deleteItem",function(P){return u(g),f(n.onActionClicked(P.actionToPerform,P.data))}),r()}if(a&2){let g,w;o(2),d("placeholder",N(c(3,11,"search_your_files")))("formControl",n.term),o(4),v(c(7,13,"sort_by_desc")),o(3),v(c(10,15,"sort_by_newest")),o(3),v(c(13,17,"sort_by_oldest")),o(3),v(c(16,19,"sort_by_smallest")),o(3),v(c(19,21,"sort_by_largest")),o(3),C(n.loading?21:22),o(2),C(!((g=c(24,23,n.attachment$))==null||g.data==null)&&g.data.length?23:-1),o(2),C(!(!((w=c(26,25,n.attachment$))==null||w.data==null)&&w.data.length)&&!n.loading?25:-1)}},dependencies:[oe,R,ce,de,pe,le,se,ge,me,be,Te,Ne,Oe,ne,$],encapsulation:2});let i=l;return i})();var Xe=["mediaModal"];function Ze(i,l){if(i&1){let t=y();s(0,"app-media-box",16),h("setImage",function(a){u(t);let n=m(3);return f(n.setImage(a))}),r()}if(i&2){let t=m(3);d("multiple",t.multipleImage())("url",t.url())("accept",t.accept())("selectedImages",t.selectedImages)("deleteAction",!1)}}function et(i,l){i&1&&(s(0,"li",7)(1,"a",14),_(2),p(3,"translate"),r(),T(4,Ze,1,5,"ng-template",15),r()),i&2&&(d("ngbNavItem","select"),o(2),v(c(3,2,"select_file")))}function tt(i,l){if(i&1){let t=y();s(0,"ngx-dropzone-image-preview",20),h("removed",function(){u(t);let a=m().$implicit,n=m(4);return f(n.onRemove(a))}),s(1,"ngx-dropzone-label"),_(2),r()()}if(i&2){let t=m().$implicit;d("file",t)("removable",!0),o(2),U("",t.name," (",t.type,")")}}function it(i,l){if(i&1){let t=y();s(0,"ngx-dropzone-preview",21),h("removed",function(){u(t);let a=m().$implicit,n=m(4);return f(n.onRemove(a))}),s(1,"ngx-dropzone-label"),_(2),r()()}if(i&2){let t=m().$implicit;d("removable",!0),o(2),U("",t.name," (",t.type,")")}}function at(i,l){if(i&1&&(M(0,tt,3,4,"ngx-dropzone-image-preview",18),M(1,it,3,3,"ngx-dropzone-preview",19)),i&2){let t=l.$implicit;C(t&&t.type.startsWith("image")?0:-1),o(),C(t&&!t.type.startsWith("image")?1:-1)}}function nt(i,l){if(i&1){let t=y();s(0,"div",17),h("change",function(a){u(t);let n=m(3);return f(n.onSelect(a))}),s(1,"ngx-dropzone-label")(2,"div")(3,"h2"),_(4),p(5,"translate"),r()()(),E(6,at,2,2,null,null,A),r()}if(i&2){let t,e=m(3);d("accept",N((t=e.accept())==null?null:t.join())),o(4),v(c(5,3,"drop_files_here")),o(2),z(e.files)}}function ot(i,l){i&1&&(s(0,"li",7)(1,"a",14),_(2),p(3,"translate"),r(),T(4,nt,8,5,"ng-template",15),r()),i&2&&(d("ngbNavItem","upload"),o(2),v(c(3,2,"upload_new")))}function lt(i,l){if(i&1){let t=y();s(0,"div",2)(1,"h2"),_(2),p(3,"translate"),r(),s(4,"app-button",3),h("click",function(){let a=u(t).$implicit;return f(a.dismiss("Cross click"))}),I(5,"i",4),r()(),s(6,"div",5)(7,"ul",6,1),ie("activeIdChange",function(a){u(t);let n=m();return te(n.active,a)||(n.active=a),f(a)}),M(9,et,5,4,"li",7),T(10,ot,5,4,"li",8),r(),I(11,"div",9),r(),s(12,"div",10),I(13,"div",11),s(14,"div",12)(15,"app-button",13),h("click",function(){let a=u(t).$implicit,n=Q(8),g=m();return f(g.active==="upload"?g.addMedia(n):g.selectedMedia(a))}),_(16),p(17,"translate"),r()()()}if(i&2){let t=Q(8),e=m();o(2),v(c(3,13,"insert_media")),o(2),W("btn btn-close"),d("spinner",!1)("id","media_close_btn"),o(3),ee("activeId",e.active),o(2),C(e.selectMedia()?9:-1),o(),d("hasPermission","attachment.create"),o(),d("ngbNavOutlet",t),o(4),W("align-items-center btn btn-theme d-flex"),d("id","media_btn"),o(),Z(" ",c(17,15,"insert_media")," ")}}var Ft=(()=>{let l=class l{constructor(){this.store=b(D),this.notificationService=b(ye),this.modalService=b(_e),this.active="select",this.modalOpen=!1,this.files=[],this.selectedImages=[],this.selectMedia=x(!0),this.multipleImage=x(!1),this.url=x(!1),this.accept=x([L.image,L.video,L.audio]),this.selectedImagesIds=x(void 0),this.MediaModal=O("mediaModal"),this.selectImage=S()}ngOnChanges(e){this.selectedImages=[],Array.isArray(e.selectedImagesIds?.currentValue)?this.selectedImages=e.selectedImagesIds?.currentValue:e.selectedImagesIds?.currentValue?this.selectedImages.push(e.selectedImagesIds?.currentValue):this.selectedImages.push(e.selectedImagesIds?.currentValue)}openModal(){return G(this,null,function*(){this.modalOpen=!0,this.selectMedia()?this.active="select":this.active="upload",this.modalService.open(this.MediaModal(),{ariaLabelledBy:"Media-Modal",centered:!0,windowClass:"theme-modal modal-xl media-modal"}).result.then(e=>{`${e}`,this.closeResult=`Closed with: ${e}`},e=>{this.closeResult=`Dismissed ${this.getDismissReason(e)}`})})}getDismissReason(e){return this.selectMedia()?this.active="select":this.active="upload",e===K.ESC?"by pressing ESC":e===K.BACKDROP_CLICK?"by clicking on a backdrop":`with: ${e}`}onSelect(e){this.files.length+e.addedFiles.length<=5?this.files.push(...e.addedFiles):this.notificationService.showError("You've reached 5 file maximum.")}onRemove(e){this.files.splice(this.files.indexOf(e),1)}addMedia(e){this.files.length&&this.active=="upload"&&this.store.dispatch(new ze(this.files)).subscribe({complete:()=>{this.files=[],this.selectMedia()?e.select("select"):this.modalService.dismissAll()}})}setImage(e){this.media=e}selectedMedia(e){this.selectImage.emit(this.media),e.dismiss("close")}ngOnDestroy(){this.modalOpen&&this.modalService.dismissAll()}};l.\u0275fac=function(a){return new(a||l)},l.\u0275cmp=B({type:l,selectors:[["app-media-modal"]],viewQuery:function(a,n){a&1&&k(n.MediaModal,Xe,5),a&2&&F()},inputs:{selectMedia:[1,"selectMedia"],multipleImage:[1,"multipleImage"],url:[1,"url"],accept:[1,"accept"],selectedImagesIds:[1,"selectedImagesIds"]},outputs:{selectImage:"selectImage"},features:[V],decls:2,vars:0,consts:[["mediaModal",""],["nav","ngbNav"],[1,"modal-header"],[3,"click","spinner","id"],[1,"ri-close-line"],[1,"modal-body"],["ngbNav","",1,"nav-tabs",3,"activeIdChange","activeId"],[3,"ngbNavItem"],[3,"ngbNavItem",4,"hasPermission"],[1,"mt-2",3,"ngbNavOutlet"],[1,"modal-footer"],[1,"left-part"],[1,"right-part"],[3,"click","id"],["ngbNavLink",""],["ngbNavContent",""],[3,"setImage","multiple","url","accept","selectedImages","deleteAction"],["ngx-dropzone","",1,"content-section","drop-files-sec",3,"change","accept"],["ngProjectAs","ngx-dropzone-preview",5,["ngx-dropzone-preview"],3,"file","removable"],[3,"removable"],["ngProjectAs","ngx-dropzone-preview",5,["ngx-dropzone-preview"],3,"removed","file","removable"],[3,"removed","removable"]],template:function(a,n){a&1&&T(0,lt,18,17,"ng-template",null,0,ae)},dependencies:[R,Ie,ue,ve,he,fe,Me,xe,Ce,we,Ae,Ve,De,Pe,Be,$e,Se,$],encapsulation:2});let i=l;return i})();export{L as a,$e as b,Ft as c};
