import{a as je}from"./chunk-EOJ72O7D.js";import{c as De,d as Me,e as S}from"./chunk-L64HS5AO.js";import{b as Ee}from"./chunk-I4EG6FBQ.js";import{b as Te}from"./chunk-SPPECMGV.js";import{a as He}from"./chunk-DRWHSBYU.js";import{a as Ge}from"./chunk-LCVX2N4P.js";import"./chunk-M3HD75V3.js";import{a as $e}from"./chunk-Y2Z4WWCH.js";import"./chunk-QVI36XHK.js";import"./chunk-HMBOAMDM.js";import{a as Pe}from"./chunk-7RQBIUSJ.js";import{a as k}from"./chunk-VO736VT2.js";import"./chunk-DNDGKAFO.js";import{a as Ie}from"./chunk-3ARB4UI6.js";import"./chunk-HD5XXWEJ.js";import"./chunk-HJPVTB2W.js";import{a as Ve}from"./chunk-MLWMDQKS.js";import{a as Se}from"./chunk-MPC4A6Z2.js";import"./chunk-Q3XL2YFP.js";import"./chunk-5DTRVH74.js";import"./chunk-GG7AHMIJ.js";import{$ as Ce,A as ce,B as pe,C as me,D as de,E as ue,F as _e,G as ge,H as he,I as fe,J as be,X as ve,Y as ye,Z as xe,_ as we,aa as Ae,ba as Ne,c as te,fa as Fe,g as ie,h as ne,i as x,k as m,m as re,q as oe,qa as N,r as ae,s as se,t as le}from"./chunk-IKKQDHIF.js";import"./chunk-OTODDIHK.js";import"./chunk-EY6JDCC6.js";import{c as Be,d as ke}from"./chunk-AWERIOQH.js";import{Ac as q,Ad as ee,Bc as Q,Fc as X,Gc as Y,Ib as G,J as P,Kb as H,Lc as b,Mb as D,Mc as v,Nb as M,Ob as j,Pb as c,Qb as l,Rb as s,Sb as w,Wb as O,Xb as U,_b as C,bb as o,bc as y,dc as u,g as V,gb as E,ja as g,mc as L,ob as $,qa as h,qc as W,ra as f,rc as A,sc as R,tc as B,td as Z,ub as F,uc as K,va as T,x as I,yc as z,zc as J}from"./chunk-KIZZVTEV.js";import"./chunk-4CLCTAJ7.js";var Ue=n=>[n],Le=()=>[];function We(n,p){if(n&1){let r=C();l(0,"app-form-fields",29)(1,"app-image-upload",30),y("selectedFiles",function(t){h(r);let i=u().$index,a=u(3);return f(a.selectHomeBannerArray(t,i))}),s()(),l(2,"app-link",31),b(3,"async"),b(4,"async"),y("productFilter",function(t){h(r);let i=u(4);return f(i.getProducts(t))}),s(),l(5,"app-form-fields",29)(6,"div",32)(7,"label",33),w(8,"input",34)(9,"span",35),s()()()}if(n&2){let r,e,t=u(),i=t.$implicit,a=t.$index,_=u(3);c("label","image")("for","image_url"),o(),c("url",!0)("multipleImage",!1)("accept",Y(15,Ue,_.mediaConfig.image))("helpText","*Upload image size 376x231px recommended")("imageUrl",(r=_.form.get("content.home_banner.banners"))==null?null:r.value[a].image_url),o(),c("products",(e=v(3,11,_.product$))!=null&&e.length?v(4,13,_.product$):X(17,Le))("linkForm",i.get("redirect_link")),o(3),c("label","status")("for","status"+a)}}function Re(n,p){if(n&1){let r=C();l(0,"div",18)(1,"div",19)(2,"div",20)(3,"div",21)(4,"div",22)(5,"button",23),A(6),b(7,"translate"),s()(),l(8,"div",24)(9,"div",25),F(10,We,10,18,"ng-template"),s()()()()(),l(11,"div",26)(12,"a",27),y("click",function(){let t=h(r).$index,i=u(3);return f(i.removeHomeBanner(t))}),w(13,"i",28),s()()()}if(n&2){let r=p.$index;c("formGroupName",Q(r)),o(3),c("collapsed",!1),o(3),K(" ",v(7,5,"banner")," ",r+1," ")}}function Ke(n,p){if(n&1&&(l(0,"div",16)(1,"div",17),O(2),M(3,Re,14,7,"div",18,D),U(),s()()),n&2){let r=u(2);o(3),j(r.homeBannersArray.controls)}}function ze(n,p){if(n&1){let r=C();l(0,"div",14)(1,"app-button",15),y("click",function(t){h(r);let i=u();return f(i.addHomeBanner(t))}),A(2),b(3,"translate"),s(),G(4,Ke,5,0,"div",16),s()}if(n&2){let r=u();o(),W("btn btn-animation mb-3"),c("id","add_banners_btn")("spinner",!1),o(),B(" ",v(3,6,"add_banners")," "),o(2),H(!(r.homeBannersArray==null||r.homeBannersArray.controls==null)&&r.homeBannersArray.controls.length?4:-1)}}function Je(n,p){n&1&&(l(0,"app-button",36),A(1),b(2,"translate"),s()),n&2&&(c("id","theme_1_submit"),o(),B(" ",v(2,2,"submit")," "))}var xt=(()=>{let p=class p{constructor(){this.store=g(N),this.formBuilder=g(pe),this.renderer=g(E),this.document=g(T),this.home_page$=g(N).select(S.homePage),this.product$=g(N).select(Ee.products),this.category$=g(N).select(Te.category),this.active="home_banner",this.search=new V,this.filter={status:1,search:"",paginate:15,ids:"",with_union_products:0,is_approved:1},this.mediaConfig=Ge,this.form=new x({content:new x({home_banner:new x({status:new m(!0),banners:new ce([])})}),slug:new m("full_page")})}ngOnInit(){let e=this.store.dispatch(new De({slug:"full_page"})),t=this.store.dispatch(new Pe({status:1,type:"product"}));I([e,t]).subscribe({complete:()=>{this.store.select(S.homePage).subscribe({next:i=>{i?.content?.products_ids&&(this.filter.paginate=i?.content?.products_ids?.length>=15?i?.content?.products_ids?.length:15,this.filter.ids=i?.content?.products_ids?.join(),this.filter.with_union_products=i?.content?.products_ids?.length?i?.content?.products_ids?.length>=15?0:1:0),this.store.dispatch(new k(this.filter)).subscribe({complete:()=>{this.patchForm()}})}})}}),this.search.pipe(P(300)).subscribe(i=>{this.filter.search=i,this.getProducts(this.filter),this.renderer.addClass(this.document.body,"loader-none")})}patchForm(){this.home_page$.subscribe(e=>{this.page_data=e,this.form.patchValue({content:{home_banner:{status:e?.content?.home_banner?.status},products_ids:e?.content?.products_ids},slug:e?.slug}),this.homeBannersArray.clear(),e?.content?.home_banner?.banners?.forEach(t=>this.homeBannersArray.push(this.formBuilder.group({redirect_link:new x({link:new m(t?.redirect_link?.link),link_type:new m(t?.redirect_link?.link_type)}),status:new m(t?.status),image_url:new m(t?.image_url)})))})}selectCategoryItem(e,t){Array.isArray(e)&&this.form.get(t)?.setValue(e)}getProducts(e){this.filter.search=e.search,this.filter.ids=this.filter.search.length?"":this.page_data?.content?.products_ids?.join(),this.filter.paginate=this.page_data?.content?.products_ids?.length>=15?this.page_data?.content?.products_ids?.length:15,this.store.dispatch(new k(this.filter)),this.renderer.addClass(this.document.body,"loader-none")}productDropdown(e){e.innerSearchText&&(this.search.next(""),this.getProducts(this.filter))}searchProduct(e){this.search.next(e.search)}get homeBannersArray(){return this.form.get("content.home_banner.banners")}addHomeBanner(e){e.preventDefault(),this.homeBannersArray.push(this.formBuilder.group({redirect_link:new x({link:new m(""),link_type:new m(""),product_ids:new m("")}),image_url:new m,status:new m(!0)}))}removeHomeBanner(e){this.homeBannersArray.length<=1||this.homeBannersArray.removeAt(e)}selectImage(e,t){this.form.get(t)?.setValue(e||null)}selectHomeBannerArray(e,t){this.homeBannersArray.at(t).get("image_url")?.setValue(e||null)}concatDynamicProductKeys(e){let t=[];function i(a){if(Array.isArray(a))a.forEach(i);else if(a!==null&&typeof a=="object")for(let[_,d]of Object.entries(a))_==="product_ids"&&Array.isArray(d)&&d.every(Oe=>typeof Oe=="number")?t.push(...d):_==="product_ids"&&typeof d=="number"?t.push(d):i(d)}return i(e),t}submit(){let e=Array.from(new Set(this.concatDynamicProductKeys(this.form.value)));this.form.get("content.products_ids")?.setValue(e),this.form.valid&&this.store.dispatch(new Me(this.page_data.id,this.form.value))}};p.\u0275fac=function(t){return new(t||p)},p.\u0275cmp=$({type:p,selectors:[["app-full-page"]],decls:16,vars:9,consts:[["nav","ngbNav"],[3,"gridClass","title"],[1,"theme-form","theme-form-2","mega-form",3,"ngSubmit","formGroup"],[1,"vertical-tabs"],[1,"row"],[1,"col-xl-3","col-lg-4"],["ngbNav","","orientation","vertical","formGroupName","content",1,"nav-pills",3,"activeIdChange","activeId"],["ngbNavItem","home_banner"],["ngbNavLink",""],[1,"ri-record-circle-line"],["ngbNavContent",""],[1,"col-xl-7","col-lg-8"],[3,"ngbNavOutlet"],[3,"id",4,"hasPermission"],["formGroupName","home_banner"],[3,"click","id","spinner"],[1,"shipping-accordion","variant-accordion"],["formArrayName","banners"],[1,"d-flex",3,"formGroupName"],[1,"col-11"],["ngbAccordion",""],["ngbAccordionItem","",3,"collapsed"],["ngbAccordionHeader",""],["ngbAccordionButton",""],["ngbAccordionCollapse",""],["ngbAccordionBody",""],[1,"col-1","text-center","fs-20"],["href","javascript:void(0)",1,"invalid-feedback","text-end","cursor-pointer","d-inline-block","w-auto","mt-2",3,"click"],[1,"ri-close-line"],[3,"label","for"],[3,"selectedFiles","url","multipleImage","accept","helpText","imageUrl"],[3,"productFilter","products","linkForm"],[1,"form-check","form-switch","ps-0"],[1,"switch"],["type","checkbox","id","status","formControlName","status"],[1,"switch-state"],[3,"id"]],template:function(t,i){if(t&1){let a=C();l(0,"app-page-wrapper",1)(1,"form",2),y("ngSubmit",function(){return h(a),f(i.submit())}),l(2,"div",3)(3,"div",4)(4,"div",5)(5,"ul",6,0),q("activeIdChange",function(d){return h(a),J(i.active,d)||(i.active=d),f(d)}),l(7,"li",7)(8,"a",8),w(9,"i",9),A(10),b(11,"translate"),s(),F(12,ze,5,8,"ng-template",10),s()()(),l(13,"div",11),w(14,"div",12),s()(),F(15,Je,3,4,"app-button",13),s()()()}if(t&2){let a=L(6);c("gridClass","col-sm-12")("title","full_page_settings"),o(),c("formGroup",i.form),o(4),z("activeId",i.active),o(5),R(v(11,7,"home_banner")),o(4),c("ngbNavOutlet",a),o(),c("hasPermission","theme.edit")}},dependencies:[ke,me,re,te,ie,ne,de,oe,le,ae,se,ee,Fe,ge,be,fe,he,ue,_e,ve,we,xe,ye,Ae,Ce,Ne,Ie,Se,Ve,$e,He,je,Be,Z],encapsulation:2});let n=p;return n})();export{xt as FullPage};
