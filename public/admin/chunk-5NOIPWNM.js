import{a as W,c as J}from"./chunk-M4SXFULB.js";import{a as S,i as Q}from"./chunk-2QIDAN5L.js";import{a as z}from"./chunk-GJUMWKSA.js";import"./chunk-6TS3CAIM.js";import"./chunk-2MGWSW7E.js";import"./chunk-T5ULGFUG.js";import"./chunk-YJGMUJNE.js";import{a as N}from"./chunk-3ARB4UI6.js";import"./chunk-HD5XXWEJ.js";import"./chunk-HJPVTB2W.js";import"./chunk-MLWMDQKS.js";import{a as H}from"./chunk-MPC4A6Z2.js";import"./chunk-Q3XL2YFP.js";import"./chunk-5DTRVH74.js";import"./chunk-GG7AHMIJ.js";import{qa as y}from"./chunk-IKKQDHIF.js";import{e as L,g as V,h as q,l as U}from"./chunk-OTODDIHK.js";import"./chunk-EY6JDCC6.js";import{c as j,d as G}from"./chunk-AWERIOQH.js";import{Ad as B,Fc as E,Lc as v,Mc as b,Nb as R,Ob as D,Pb as u,Qb as l,Rb as m,Sb as K,_b as A,bb as o,bc as f,dc as C,gb as k,ja as s,ob as $,oc as w,qa as T,qc as M,ra as x,rc as c,sc as h,tc as P,td as I,ub as F,va as O}from"./chunk-KIZZVTEV.js";import{a as _,b as g}from"./chunk-4CLCTAJ7.js";var X=()=>["/order/create"],Y=(n,a)=>a.id;function Z(n,a){n&1&&(l(0,"div",7)(1,"a",8),K(2,"i",9),c(3),v(4,"translate"),m()()),n&2&&(o(),u("routerLink",E(4,X)),o(2),P(" ",b(4,2,"add_order")," "))}function ee(n,a){if(n&1){let d=A();l(0,"li")(1,"a",5),f("click",function(){let i=T(d).$implicit,t=C();return x(t.filterOrder(i.value))}),c(2),l(3,"span"),c(4),m()()()}if(n&2){let d=a.$implicit,e=C();M(d.color),w("active",e.selectedStatus===d.value?"active":""),o(2),P("",d.label," "),o(2),h(d.count)}}var be=(()=>{let a=class a{constructor(){this.store=s(y),this.activatedRoute=s(L),this.router=s(V),this.renderer=s(k),this.document=s(O),this.order$=s(y).select(Q.order),this.statistics$=s(y).select(J.statistics),this.tableConfig={columns:[{title:"order_number",dataField:"order_id"},{title:"order_date",dataField:"created_at",type:"date",sortable:!0,sort_direction:"desc"},{title:"customer_name",dataField:"consumer_name"},{title:"total_amount",dataField:"total",type:"price"},{title:"payment_status",dataField:"order_payment_status"},{title:"payment_method",dataField:"payment_mode"}],rowActions:[{label:"View",actionToPerform:"view",icon:"ri-eye-line",permission:"order.edit"}],data:[],total:0},this.filterPills=[{id:1,value:"pending",label:"Pending",countKey:"total_pending_orders",color:"pending"},{id:2,value:"processing",label:"Processing",countKey:"total_processing_orders",color:"processing"},{id:3,value:"cancelled",label:"Cancelled",countKey:"total_cancelled_orders",color:"cancel"},{id:4,value:"shipped",label:"Shipped",countKey:"total_shipped_orders",color:"shipped"},{id:5,value:"out_for_delivery",label:"Out for delivery",countKey:"total_out_of_delivery_orders",color:"out-delivery"},{id:6,value:"delivered",label:"Delivered",countKey:"total_delivered_orders",color:"completed"}],this.filter={}}ngOnInit(){this.order$.subscribe(e=>{let i=e?.data?.filter(t=>(t.order_id=`<span class="fw-bolder">#${t?.order_number}</span>`,t.order_payment_status=t?.payment_status?`<div class="status-${t.payment_status.toLowerCase()}"><span>${t.payment_status.replace(/_/g," ")}</span></div>`:"-",t.payment_mode=t?.payment_method?`<div class="payment-mode"><span>${t.payment_method.replace(/_/g," ").toUpperCase()}</span></div>`:"-",t.consumer_name=`<span class="text-capitalize">${t?.consumer?.name}</span>`,t));this.tableConfig.data=e?i:[],this.tableConfig.total=e?e?.total:0}),this.statistics$.subscribe(e=>{this.filterPills.forEach((i,t)=>{let r=i.countKey;e&&e.hasOwnProperty(r)&&(i.count=e[r])})}),this.activatedRoute.queryParams.subscribe(e=>{this.filter=g(_({},this.filter),{status:e.status?e.status:""}),this.selectedStatus=e.status,this.store.dispatch(new S(this.filter))})}onTableChange(e){let i=e&&e.start_date?e.start_date:"",t=e&&e.end_date?e.end_date:"",r=this.selectedStatus?this.selectedStatus:"";this.filter=g(_(_({},this.filter),e),{start_date:i,end_date:t}),this.filter.status=r,this.store.dispatch(new S(this.filter)),this.store.dispatch(new W({start_date:i,end_date:t,status:r}))}onActionClicked(e){e.actionToPerform=="view"&&this.view(e.data)}view(e){this.router.navigateByUrl(`/order/details/${e.order_number}`)}filterOrder(e){this.renderer.addClass(this.document.body,"loader-none"),this.router.navigate([],{queryParams:{status:e||null},queryParamsHandling:"merge"})}};a.\u0275fac=function(i){return new(i||a)},a.\u0275cmp=$({type:a,selectors:[["app-order"]],decls:14,vars:13,consts:[[3,"gridClass","title"],["button","",4,"hasPermission"],[3,"tableChanged","rowClicked","action","tableConfig","dateRange"],["advanceFilter","",1,"show-box","mb-4","d-block"],[1,"order-tab-content"],["href","javascript:void(0)",3,"click"],[3,"active","class"],["button",""],[1,"align-items-center","btn","btn-theme","d-flex",3,"routerLink"],[1,"ri-add-line"]],template:function(i,t){if(i&1&&(l(0,"app-page-wrapper",0),F(1,Z,5,5,"div",1),l(2,"app-table",2),f("tableChanged",function(p){return t.onTableChange(p)})("rowClicked",function(p){return t.view(p)})("action",function(p){return t.onActionClicked(p)}),l(3,"div",3)(4,"ul",4)(5,"li")(6,"a",5),f("click",function(){return t.filterOrder("")}),c(7),v(8,"translate"),l(9,"span"),c(10),v(11,"async"),m()()(),R(12,ee,5,6,"li",6,Y),m()()()()),i&2){let r;u("gridClass","col-sm-12")("title","orders"),o(),u("hasPermission","order.create"),o(),u("tableConfig",t.tableConfig)("dateRange",!0),o(3),w("active",!t.selectedStatus),o(2),h(b(8,9,"all")),o(3),h((r=b(11,11,t.statistics$))==null?null:r.total_orders),o(2),D(t.filterPills)}},dependencies:[B,G,U,q,N,H,z,I,j],encapsulation:2});let n=a;return n})();export{be as Order};
